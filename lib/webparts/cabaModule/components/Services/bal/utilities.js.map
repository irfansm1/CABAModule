{"version":3,"sources":["webparts/cabaModule/components/Services/bal/utilities.ts"],"names":[],"mappings":"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","file":"webparts/cabaModule/components/Services/bal/utilities.js","sourcesContent":["import { WebPartContext } from \"@microsoft/sp-webpart-base\";\nimport { ICabaModuleProps } from \"../interface/ICabaModuleProps\";\n// import { IEmailProperties } from \"@pnp/sp/sputilities\";\nimport { sp } from \"sp-pnp-js\";\nexport interface IMonth {\n    Id: number;\n    Title: string;\n    ShortMonth: string;\n    NarrowMonth: string;\n}\n\nexport interface TypedHash<T> {\n    [key: string]: T;\n}\n\nexport interface IUtilities {\n    filterData(jsonData: any, filterValue: string, excludeColumns: Array<string>): Promise<any>;\n    MonthColl(): Array<IMonth>;\n    hideShow(hideIt: boolean, props: WebPartContext, loadingMessage: string): void;\n    // sendEmail(to: string[], cc: string[], bcc: string[], subject: string, body: string, AdditionalHeaders: TypedHash<string>\n    //     , props: IEximBankProps, from?: string): void;\n}\n\nexport default function Utilities() {\n    const filterData = async (jsonData: any, filterValue: string, includeColumns: Array<string>) => {\n        const lowercasedValue = filterValue.toLowerCase().trim();\n        if (lowercasedValue === \"\") return jsonData;\n        else {\n            const filteredData = jsonData.filter(item => {\n                return Object.keys(item).some(key =>\n                    includeColumns.includes(key) ? item[key] !== undefined && item[key] !== null ? item[key].toString().toLowerCase().includes(lowercasedValue) : false : false\n                );\n            });\n            return filteredData;\n        }\n    };\n\n    const MonthColl = () => {\n        let Years: Array<IMonth> = new Array<IMonth>();\n        let dateObj = new Date();\n\n        for (let m = 0; m <= 11; m++) {\n            let particularDate = new Date(dateObj.getFullYear(), m, 1);\n            Years.push({\n                Id: m + 1,\n                Title: particularDate.toLocaleString('en-us', { month: 'long' }),\n                ShortMonth: particularDate.toLocaleString('en-us', { month: 'short' }),\n                NarrowMonth: particularDate.toLocaleString('en-us', { month: 'narrow' })\n            });\n        }\n\n        return Years;\n    };\n\n    const hideShow = (hideIt: boolean, ctx: WebPartContext, loadingMessage: string) => {\n        if (hideIt) {\n            ctx.statusRenderer.clearLoadingIndicator(document.getElementById('divBlockRequestsLoader'));\n            document.getElementById('divBlockRequestsLoader').setAttribute(\"style\", \"height: 0px !important;\");\n        }\n        else {\n            document.getElementById('divBlockRequestsLoader').setAttribute(\"style\", \"height: 1100px !important;\");\n            ctx.statusRenderer.displayLoadingIndicator(document.getElementById('divBlockRequestsLoader'), loadingMessage, 1);\n\n        }\n    };\n\n    // const sendEmail = async (to: string[], cc: string[], bcc: string[], subject: string, body: string\n    //     , additionalHeaders: TypedHash<string>, props: IEximBankProps, from?: string) => {\n\n    //     const emailProps: IEmailProperties = {\n    //         To: to,\n    //         CC: cc,\n    //         BCC: bcc,\n    //         Subject: subject,\n    //         Body: body\n    //     };\n\n    //     if (from !== null && from !== undefined && from.trim() !== \"\") {\n    //         emailProps.From = from;\n    //     }\n    //     if (additionalHeaders !== null && additionalHeaders !== undefined) {\n    //         emailProps.AdditionalHeaders = additionalHeaders;\n    //     }\n        \n    //     return await sp.utility.sendEmail(emailProps);\n    // };\n\n    return {\n        filterData,\n        MonthColl,\n        hideShow,\n        //sendEmail\n    };\n}"],"sourceRoot":"../../../../../../src"}